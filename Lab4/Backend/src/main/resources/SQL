CREATE TABLE LAB4_HITS
(
  ID INTEGER NOT NULL
, X BINARY_DOUBLE NOT NULL
, Y BINARY_DOUBLE NOT NULL
, R BINARY_DOUBLE NOT NULL
, RESULT NUMBER(1) NOT NULL
, USER_ID INTEGER
, CONSTRAINT LAB4_HITS_PK PRIMARY KEY
  (
    ID
  )
  ENABLE
);

CREATE SEQUENCE LAB4_HITS_SEQ;

CREATE TRIGGER LAB4_HITS_TRG
BEFORE INSERT ON LAB4_HITS
FOR EACH ROW
BEGIN
  <<COLUMN_SEQUENCES>>
  BEGIN
    IF INSERTING AND :NEW.ID IS NULL THEN
      SELECT LAB4_HITS_SEQ.NEXTVAL INTO :NEW.ID FROM SYS.DUAL;
    END IF;
  END COLUMN_SEQUENCES;
END;





CREATE TABLE USERS
(
  ID INTEGER NOT NULL
, USERNAME VARCHAR2(20) NOT NULL
, PASSWORD VARCHAR2(100) NOT NULL
, CONSTRAINT USERS_PK PRIMARY KEY
  (
    ID
  )
  ENABLE
);

CREATE SEQUENCE USERS_SEQ;

CREATE TRIGGER USERS_TRG
BEFORE INSERT ON USERS
FOR EACH ROW
BEGIN
  <<COLUMN_SEQUENCES>>
  BEGIN
    IF INSERTING AND :NEW.ID IS NULL THEN
      SELECT USERS_SEQ.NEXTVAL INTO :NEW.ID FROM SYS.DUAL;
    END IF;
  END COLUMN_SEQUENCES;
END;





CREATE TABLE ROLES
(
  ID INTEGER NOT NULL
, NAME VARCHAR2(20) NOT NULL
, CONSTRAINT ROLES_PK PRIMARY KEY
  (
    ID
  )
  ENABLE
);

CREATE SEQUENCE ROLES_SEQ;

CREATE TRIGGER ROLES_TRG
BEFORE INSERT ON ROLES
FOR EACH ROW
BEGIN
  <<COLUMN_SEQUENCES>>
  BEGIN
    IF INSERTING AND :NEW.ID IS NULL THEN
      SELECT ROLES_SEQ.NEXTVAL INTO :NEW.ID FROM SYS.DUAL;
    END IF;
  END COLUMN_SEQUENCES;
END;





CREATE TABLE USER_ROLES
(
  ID INTEGER NOT NULL
, USER_ID INTEGER NOT NULL
, ROLE_ID INTEGER NOT NULL
, CONSTRAINT USER_ROLES_PK PRIMARY KEY
  (
    ID
  )
  ENABLE
);

CREATE SEQUENCE USER_ROLES_SEQ;

CREATE TRIGGER USER_ROLES_TRG
BEFORE INSERT ON USER_ROLES
FOR EACH ROW
BEGIN
  <<COLUMN_SEQUENCES>>
  BEGIN
    IF INSERTING AND :NEW.ID IS NULL THEN
      SELECT USER_ROLES_SEQ.NEXTVAL INTO :NEW.ID FROM SYS.DUAL;
    END IF;
  END COLUMN_SEQUENCES;
END;






ALTER TABLE USER_ROLES
ADD CONSTRAINT USER_ROLES_FK1 FOREIGN KEY
(
  USER_ID
)
REFERENCES USERS
(
  ID
)
ENABLE;

ALTER TABLE USER_ROLES
ADD CONSTRAINT USER_ROLES_FK2 FOREIGN KEY
(
  ROLE_ID
)
REFERENCES ROLES
(
  ID
)
ENABLE;

ALTER TABLE LAB4_HITS
ADD CONSTRAINT LAB4_HITS_FK1 FOREIGN KEY
(
  USER_ID
)
REFERENCES USERS
(
  ID
)
ENABLE;